# Phase 2.2 学习管理系统产品需求文档

## 项目概述

**项目名称**: 小芽家教 Phase 2.2 学习管理系统
**项目 ID**: LWP-2.2
**标签**: learning-management
**日期**: 2025-01-15

## 描述

实现一个综合的学习管理系统，追踪学生学习进度，提供苏格拉底式教学指导，管理知识点。该系统为一年级学生提供个性化学习体验，同时确保数据安全和 COPPA 合规。

## 技术栈

- 编程语言：Python 3.11+
- Web 框架：FastAPI, SQLAlchemy, Pydantic v2
- 数据库：SQLite (开发环境) / PostgreSQL (生产环境)
- 测试框架：pytest, pytest-asyncio
- 外部服务：Claude API (Anthropic SDK)
- 安全加密：AES-256 加密（儿童数据保护）

## 开发原则

- 遵循 TDD 开发流程：红灯 → 绿灯 → 重构
- 测试覆盖率目标：≥ 80%
- 每个阶段独立提交到 Git

## 用户故事

### 用户故事 1：学习记录追踪

让学生和家长能够追踪学习进度，包括学习时间、完成题目数量、正确率等。

**优先级**: P1 (高)

**实施任务**:

1. **环境搭建与基础**
   - 配置 Claude API 集成环境
   - 安装 Python 依赖包 (anthropic, cryptography)
   - 创建数据加密服务（儿童数据安全）
   - 设置数据库加密工具

2. **数据模型**
   - 创建学习记录扩展模型 (LearningRecord)
   - 创建错题记录模型 (WrongAnswerRecord)
   - 创建知识点模型 (KnowledgePoint)
   - 创建知识点掌握模型 (KnowledgeMastery)
   - 创建知识点依赖关系模型 (KnowledgePointDependency)

3. **数据库设置**
   - 创建数据库迁移脚本
   - 初始化知识点数据

4. **API 与服务**
   - 编写学习记录 API 测试（红灯阶段）
   - 扩展学习记录 API 端点
   - 实现学习追踪服务
   - 编写学习记录集成测试

### 用户故事 2：苏格拉底式教学引导

实现 AI 驱动的苏格拉底式教学，引导学生思考而非直接给出答案。

**优先级**: P1 (高)

**实施任务**:

1. **核心服务**
   - 编写苏格拉底教学服务测试（红灯阶段）
   - 实现错误答案分类器
   - 实现响应验证系统
   - 集成 Claude API 生成引导式响应
   - 实现引导教学 API 端点
   - 编写引导教学集成测试

### 用户故事 3：知识点管理

管理课程知识点、依赖关系和学生掌握程度。

**优先级**: P2 (中)

**实施任务**:

1. **数据管理**
   - 创建知识点 CRUD 操作
   - 实现知识点依赖解析
   - 构建知识点推荐引擎

2. **API 与服务**
   - 编写知识点 API 测试
   - 实现知识点管理端点
   - 创建知识点评估服务

### 用户故事 4：进度分析

为家长和教师生成学习进度报告。

**优先级**: P2 (中)

**实施任务**:

1. **分析功能**
   - 实现学习进度计算
   - 创建掌握程度评估
   - 构建进度趋势分析

2. **报告功能**
   - 编写进度报告 API 测试
   - 实现进度报告端点
   - 创建 PDF 报告生成

## 质量要求

- 所有 API 端点必须有完整的测试
- 测试覆盖率必须 ≥ 80%
- 儿童数据必须在静态存储时加密
- API 响应时间必须 < 500ms (p95)
- 系统必须满足 COPPA 合规要求

## 验收标准

- 学生能够准确追踪学习进度
- AI 导师提供苏格拉底式引导（不直接给答案）
- 家长能够查看详细的进度报告
- 知识点组织合理，依赖关系清晰
- 系统满足 COPPA 合规要求
- 测试覆盖率 ≥ 80%

## 约束条件

- 必须使用 Claude API 生成 AI 响应
- 数据库必须同时支持 SQLite（开发）和 PostgreSQL（生产）
- 所有儿童数据必须加密
- 系统必须可部署到生产环境
