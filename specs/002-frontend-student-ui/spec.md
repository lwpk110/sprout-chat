# Feature Specification: 小芽家教前端学生界面

**Feature Branch**: `002-frontend-student-ui`
**Created**: 2025-01-13
**Status**: Draft
**Input**: User description: "实现小芽家教前端 React 应用，为一年级学生提供语音对话和拍照上传作业的 AI 学习界面"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 语音对话学习 (Priority: P1)

一年级学生通过语音与 AI 小芽老师对话，提问数学问题，获得引导式回答而非直接答案，培养思考能力。

**Why this priority**: 核心交互方式，符合儿童口语表达习惯，是学习的主要入口。

**Independent Test**: 学生可以独立完成语音提问并获得响应，无需任何其他功能。

**Acceptance Scenarios**:

1. **Given** 学生打开主页，**When** 点击麦克风按钮并说出"7+5等于几"，**Then** 界面显示引导式提示"试着把7拆成5和几呢？"
2. **Given** 学生收到引导提示后，**When** 再次说出"我知道了，是12"，**Then** AI给予鼓励"答对了！你真棒"并记录学习进度
3. **Given** 学生提问时，**When** 语音识别失败或网络中断，**Then** 显示友好的重试提示"没听清，再说一次好吗？"
4. **Given** 学生使用语音交互，**When** 连续3次获得正确答案，**Then** 显示动画奖励(如小芽成长)

---

### User Story 2 - 拍照上传作业 (Priority: P2)

学生通过拍照上传手写作业或练习题，AI 识别题目内容并提供个性化辅导。

**Why this priority**: 支持书面作业场景，扩展学习方式，但依赖语音交互的基础体验。

**Independent Test**: 学生可以独立拍照上传并获得识别结果和反馈，无需语音功能。

**Acceptance Scenarios**:

1. **Given** 学生打开主页，**When** 点击相机按钮并对准作业拍照，**Then** 界面显示上传进度并返回识别结果"这道题是..."
2. **Given** 拍照上传后，**When** 图片模糊或无法识别，**Then** 提示"照片不清楚，重新拍一张好吗？"
3. **Given** AI识别出题目后，**When** 学生选择"需要提示"，**Then** 显示引导式教学问题而非答案
4. **Given** 学生完成拍照学习，**When** 查看学习记录，**Then** 显示历史作业照片和对应的学习轨迹

---

### User Story 3 - 学习进度可视化 (Priority: P3)

学生和父母可以查看学习进度，包括已掌握知识点、错题本、学习时长等，激励持续学习。

**Why this priority**: 增强学习动机和家庭参与，但不影响核心学习流程。

**Independent Test**: 学生可以查看进度图表和成就徽章，无需语音或拍照功能。

**Acceptance Scenarios**:

1. **Given** 学生完成5道数学题，**When** 打开进度页面，**Then** 显示"已掌握20个知识点"和成长曲线图
2. **Given** 学生查看错题本，**When** 点击某个错题，**Then** 显示原题、错误原因和针对性练习建议
3. **Given** 父母查看学习报告，**When** 查看本周学习时长，**Then** 显示"本周学习了3小时，比上周多20%"
4. **Given** 学生掌握新知识点，**When** 返回主页，**Then** 显示解锁的新徽章或等级提升动画

---

### Edge Cases

- **网络断开**: 学生离线时如何保存语音输入和拍照数据，并在恢复后自动上传？
- **麦克风权限**: 设备无麦克风或权限被拒绝时，如何提示并提供替代输入方式？
- **语音识别准确率**: 学生口音或发音不清导致识别失败，如何提供重试或文本输入备选？
- **摄像头权限**: 设备无摄像头或权限被拒绝时，如何降级到纯语音交互？
- **多标签页/设备切换**: 学生在不同设备间切换时，如何保持会话状态和学习进度同步？
- **超时无响应**: 学生长时间无操作（如思考或离开），如何处理会话超时并保持上下文？
- **并发冲突**: 学生同时在多个设备操作，如何避免数据冲突和覆盖？
- **图片大小限制**: 学生拍照上传高分辨率图片导致上传缓慢或失败，如何处理压缩和重试？

## Requirements *(mandatory)*

### Functional Requirements

**核心交互**:
- **FR-001**: 界面必须提供麦克风按钮，点击后开始语音录制，再次点击或3秒无声音自动结束
- **FR-002**: 界面必须提供相机按钮，点击后调用设备摄像头并实时预览拍照画面
- **FR-003**: 系统必须在语音录制时显示视觉反馈（如波形动画），让学生知道正在录音
- **FR-004**: 系统必须在拍照时提供实时预览，并在拍照后确认图片质量（模糊检测）

**AI响应展示**:
- **FR-005**: 系统必须以对话气泡形式展示AI的引导式教学响应，字体大小适合儿童阅读（至少18px）
- **FR-006**: 系统必须在AI响应生成时显示加载动画（如小芽老师思考表情），避免学生焦虑等待
- **FR-007**: 系统必须区分不同类型响应（引导提示、鼓励、错误提示）并使用不同颜色或图标标识

**会话管理**:
- **FR-008**: 系统必须自动保存学习会话，包括所有对话历史、上传图片和AI响应，支持页面刷新后恢复
- **FR-009**: 系统必须提供"新学习"按钮，清空当前对话并开始新会话
- **FR-010**: 系统必须在会话历史中显示时间戳（相对时间，如"5分钟前"）

**错误处理**:
- **FR-011**: 系统必须在语音识别失败时显示友好错误提示，并提供重试按钮（至少3次重试机会）
- **FR-012**: 系统必须在图片上传失败时显示具体原因（网络错误、格式不支持等）和解决建议
- **FR-013**: 系统必须在AI服务超时（>10秒无响应）时显示"小芽老师正在思考，请稍候"并提供取消按钮

**学习进度**:
- **FR-014**: 系统必须提供进度页面入口，显示知识点掌握数量、学习时长、连续学习天数
- **FR-015**: 系统必须在学生完成学习目标（如每日5道题）时显示庆祝动画和成就徽章
- **FR-016**: 系统必须提供错题本入口，按时间倒序显示所有错误题目和订正状态

**适龄设计**:
- **FR-017**: 所有按钮必须足够大（至少48x48px），避免误触，符合一年级学生手指操作习惯
- **FR-018**: 界面必须使用大字体（正文至少16px，标题至少24px）和高对比度配色，保护视力
- **FR-019**: 界面必须使用视觉图标辅助文字理解（如麦克风图标、相机图标、奖杯图标）
- **FR-020**: 界面必须提供语音播报AI响应的功能，帮助不熟悉文字的学生理解内容

**隐私与安全**:
- **FR-021**: 系统必须在首次使用麦克风和摄像头时请求权限，并用儿童友好语言解释用途（如"让小芽听听你的问题"）
- **FR-022**: 系统必须在上传图片前在本地预览，确认不会上传敏感信息（如人脸、身份证）
- **FR-023**: 系统必须提供"清空所有数据"功能，删除所有语音、图片和会话记录

**性能要求**:
- **FR-024**: 语音录制启动延迟必须 < 500ms，避免学生等待
- **FR-025**: 界面响应时间（按钮点击、页面切换）必须 < 200ms，提供即时反馈
- **FR-026**: 图片上传必须在5秒内完成（图片 < 5MB），并显示进度条

### Key Entities

- **学习会话 (Session)**: 代表一次完整的学习互动，包含开始时间、结束时间、对话轮次、使用的交互方式（语音/拍照/混合）
- **对话轮次 (Turn)**: 会话中的单次交互，包含学生输入（语音文本或图片）、AI响应、时间戳、是否正确
- **学习记录 (LearningRecord)**: 记录学生掌握的知识点、学习时长、错误次数、订正状态
- **知识点 (KnowledgePoint)**: 代表一年级数学的具体概念（如"20以内加法"、"图形认知"），包含名称、描述、掌握程度
- **错题 (Mistake)**: 记录学生的错误题目，包含题目内容、错误原因、订正答案、是否已掌握

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 一年级学生可以独立完成语音提问并理解AI响应，任务完成率 ≥ 90%（通过用户测试验证）
- **SC-002**: 语音交互端到端延迟（从点击麦克风到显示AI响应）≤ 4秒，包含语音识别、AI处理、界面渲染
- **SC-003**: 拍照上传端到端延迟（从点击相机到显示识别结果）≤ 6秒，包含拍照、上传、识别
- **SC-004**: 界面按钮误触率 ≤ 5%，通过适龄设计（大按钮、合理间距）验证
- **SC-005**: 学生满意度（通过简单问卷"你喜欢用小芽学习吗？"）≥ 85%
- **SC-006**: 父母满意度（通过问卷"你觉得这个界面适合你的孩子吗？"）≥ 80%
- **SC-007**: 学习会话保存成功率 ≥ 99.9%，数据丢失几乎为零
- **SC-008**: 错误提示友好性（用户能理解并采取行动）≥ 95%，通过用户测试验证

### Business Impact

- **SC-009**: 日活跃学生用户平均使用时长 ≥ 15分钟/天
- **SC-010**: 学生7日留存率 ≥ 60%（说明界面吸引儿童持续使用）
- **SC-011**: 父母推荐意愿（NPS）≥ 40

## Out of Scope

以下功能明确不包含在本规范中：
- 父母管理控制面板（屏幕时间限制、学习目标设置）属于 LWP-5
- 多科目支持（阅读、科学等）属于 LWP-6
- 实时视频通话功能
- 社交功能（学生之间互动、排行榜）
- 付费订阅功能

## Assumptions

- 后端API已实现（基于 001-learning-management 规范），前端只需对接
- 学生使用平板或手机访问，设备具备麦克风和摄像头
- 学生有基本的触屏操作能力（无需键盘输入）
- 父母会协助初次使用（授予麦克风/摄像头权限）
- 网络环境稳定（4G/WiFi），但需处理弱网和离线场景
- 学生主要使用中文，界面无需多语言支持

## Dependencies

- **后端API**: 依赖 001-learning-management 规范定义的对话、OCR、学习记录API
- **认证系统**: 依赖 Phase 2.1 用户认证系统，识别学生身份
- **语音识别**: 使用浏览器内置 Web Speech API（无需后端支持）
- **OCR服务**: 依赖后端提供的图片识别API（具体实现由后端决定）

## Risks & Mitigations

| Risk | Impact | Likelihood | Mitigation |
|------|--------|------------|------------|
| Web Speech API 在某些浏览器不支持 | 高 | 中 | 提供文本输入备选方案，检测浏览器兼容性并提示 |
| 一年级学生无法理解复杂错误提示 | 高 | 高 | 所有错误提示使用简单语言，配图示和语音播报 |
| 图片上传耗尽移动流量 | 中 | 中 | 在弱网环境下自动压缩图片，显示数据消耗提示 |
| 家长担心隐私（录音/拍照） | 高 | 中 | 明确隐私政策，数据本地加密，提供一键删除功能 |
| 学生沉迷界面动画影响学习 | 中 | 低 | 控制动画时长（< 3秒），专注学习内容而非娱乐 |

## Open Questions

*无 - 本规范基于现有前端代码和后端API规范，假设技术方案明确。*
